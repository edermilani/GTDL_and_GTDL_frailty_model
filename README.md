In this code we present the main functions developed for the article "Incorporation of frailties into a non-proportional hazard regression model and its diagnostics for reliability modeling of downhole safety valves"

The code is divided into 4 parts, with 

Part 1) Reading the data. A data set was generated by the GTDL model. It is presented in the file example_gtdl.csv 

Part 2) Verification of assumption of proportional hazard Part 

3) Maximum likelihood estimation Part 

4) Diagnostic analysis. Through the analysis of randomized quantile residuals and global influence.

The data set must be configured as follows

- the first column is the identification of the system / patient;

- the second column should indicate the time until failure (> 0);

- the third column must be the censor indicator variable (0 or 1).

- the fourth column is the intercept (equal to 1).

- the other columns must represent the values observed for the covariates.
